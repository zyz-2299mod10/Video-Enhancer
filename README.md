# NTU 2025 Fall Digital Image Processing Final Project

This project is to improve the image quality and to develop new functionalities of a USB camera. Use the images generated by the camera as the input of our algorithm(s). Our implementmentation including barrel distortion adjustment, under- and over-exposure correction, white balance, image super-resolution. For implementation detail please check `report.pdf`

## Demo
### Final demo
#### Demo 1
* **Before** 


https://github.com/user-attachments/assets/a74273d4-9494-4dab-a411-bb275cdb33d9 


* **After** 


https://github.com/user-attachments/assets/27e32a8b-73e3-45a1-8f01-78ad3358a7c4


#### Demo 2
* **Before** 


https://github.com/user-attachments/assets/fae98e5e-c39c-423d-ad40-f4faf2f05fe0


* **After** 


https://github.com/user-attachments/assets/1800d071-99b9-432e-be22-bc99133b2027


### method comparison
#### exposure adjustment
* **Before** 
<img width="1000" height="500" alt="image" src="https://github.com/user-attachments/assets/73ae1823-06ac-4d03-ba85-900d530af2c1" />

* **After** 
<img width="1000" height="500" alt="image" src="https://github.com/user-attachments/assets/9fb223cb-504d-439b-bc8d-fea2311a2c68" />

#### barrel distortion
* **Before**
<img width="1000" height="500" alt="image" src="https://github.com/user-attachments/assets/c1357358-6a56-4383-8780-ace40ee38000" />

* **After**
<img width="1000" height="500" alt="image" src="https://github.com/user-attachments/assets/fb5af592-0640-45ce-9a00-1ef1613b5899" />

#### Super-Resolution
* **Before**


https://github.com/user-attachments/assets/a131608b-fcb1-43ad-b5fb-a1ed0022b14c


* **After**


https://github.com/user-attachments/assets/722947f2-2905-4176-a5e6-8fb7da3734db



## Install
```
conda create -n DIP python=3.10
conda activate DIP

pip install torch torchvision --index-url https://download.pytorch.org/whl/cu130 (Check your CUDA-torch version from https://pytorch.org/get-started/previous-versions/)
pip install -r requirements.txt

# for Real-ESRGAN
cd Real_ESRGAN
python setup.py develop
```

## Usage

### Video processing
Run the main script `main.py` to process videos:

```bash
python main.py --input <input_video_path> --output <output_video_path> [options]
```

### Options
- `--input`: Path to the input video file.
- `--output`: Path to save the processed video.
- `--demo`: Enable demo mode to draw debug information (Current Mode, Average Brightness) on the video frames.
- `--test`: Select the processing pipeline mode.
  - `light`: Only applying light enhancement.
  - `detail`: Only applying distortion correction.
  - `all` (default): Apply light enhancement followed by distortion correction.
- `--sr`: Enable Real-ESRGAN Super Resolution (Upscale x2 by default).

For online demo:
```bash
python demo.py --output <output_video_path> [--option]
```

### Options
- `--output`: Path to save the processed video.
- `--demo`: Enable demo mode to draw debug information (Current Mode, Average Brightness) on the video frames.
- `--test`: Select the processing pipeline mode.
  - `light`: Only applying light enhancement.
  - `detail`: Only applying distortion correction.
  - `all` (default): Apply light enhancement followed by distortion correction.
- `--sr`: Enable Real-ESRGAN Super Resolution (Upscale x2 by default).

## Requirements

-   Python 3.x
-   OpenCV (`opencv-python`)
-   NumPy
-   PyTorch
-   ffmpeg-python
-   BasicSR / Real-ESRGAN dependencies
